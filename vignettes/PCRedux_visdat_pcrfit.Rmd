---
title: "PCRedux Package - Visualization Data Structure"
author: "Stefan R&ouml;diger"
date: "`r Sys.Date()`"
output: 
  rmarkdown::pdf_document:
    number_sections: true
    toc: true
    toc_depth: 5
header-includes:
    - \usepackage[font={small}]{caption}
bibliography: "literature.bib"
classoption: a4paper
vignette: >
  %\VignetteIndexEntry{PCRedux package - Visualization Data Structure}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, echo=FALSE}
knitr::opts_chunk$set(fig.lp = "", out.extra='', warnings = FALSE, message = FALSE)

visdat_pcrfit_plot <- "Application of ``visdat\\_pcrfit()`` for the visualization of the data structure after an analysis by ``pcrfit\\_single()``. The amplification curves (A01 = 1, A02 = 2, A04 = 3, B04 = 4) from the `C126EG685` dataset were analyzed with the ``pcrfit\\_single()`` function and then visualized with the ``visdat\\_pcrfit()`` function. For each observation, the classes (factor, integer, logical, numeric, NA) are presented. For the observations 2 and 4 the parameter `loglin\\_slope` could not be calculated (returned NA)."

visdat_pcrfit_plot_short <- "Application of ``visdat\\_pcrfit()`` for the visualization of the data structure after an analysis by ``pcrfit\\_single()``"
```

#### ``visdat_pcrfit()`` - A Function to Visualize the Content of Data From an Analysis with the ``pcrfit_single()`` Function \label{section_visdat_pcrfit_parallel}


In all data science projects it is important to look at a new dataset to gain an insight into what is contained therein and, which potential problems might emerge during the further analysis. The ``pcrfit_single()`` function uses various algorithms to calculate parameters (features) that are returned as factors (e.&nbsp;g., fitted model) or numbers (e.&nbsp;g., Cq value). In some cases are selected  algorithms not able to calculate certain features. As a result missing values (NA) are extreme values are output instead.

The ``visdat_pcrfit()`` function uses the ``vis_dat()`` function from the \texttt{visdat} package [@Tierney2017] to create heatmap-like visualizations. The Heatmapt displays each amplification curve line by line and reads from top to bottom. The characteristics are presented column by column. The structure of the output is the same as for the ``pcrfit_single()`` and ``encu()`` functions. 

The observations "A01", "A02", "A04" and "B04" from the ``C126EG685`` dataset were analyzed with the ``encu()`` function. Finally, the data were visualized with the ``visdat_pcrfit()`` function. In this example the static plot is shown (\autoref{visdat_pcrfit_plot}). It is also possible to run the function interactively by setting the parameter `interactive=TRUE`. In this case starts an interactive, browser-based charting library that uses ECMA Script. The interactive plot are rendered entirely locally, through a HTML widgets framework

```{r visdat_pcrfit_plot, echo=TRUE, fig.cap=visdat_pcrfit_plot, fig.scap=visdat_pcrfit_plot_short, fig.height=8}
# Calculate curve features of an amplification curve dataset.
# Use the C126EG685 dataset from the chipPCR package and analyze the observations
# A01, A02, A04 and B05.

library(chipPCR)
library(PCRedux)

res <- encu(C126EG685[, c(1,2,3,5,17)])

# Show all results in a plot. Note that the interactive parameter is set to
# FALSE.

visdat_pcrfit(res, type = "all", interactive = FALSE)
```


#### References
