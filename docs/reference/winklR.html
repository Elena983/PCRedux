<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>winklR: A function to calculate the angle based on the first and the second #' derivative of an amplification curve data
from a quantitative PCR experiment. — winklR • PCRedux</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="winklR: A function to calculate the angle based on the first and the second #' derivative of an amplification curve data
from a quantitative PCR experiment. — winklR" />

<meta property="og:description" content="winklR is a function to calculate the in the trajectory of the first
and the second derivatives maxima and minima  of an amplification curve data
from a quantitative PCR experiment. For the determination of the angle, the
origin is the maximum of the first derivative. On this basis, the vectors to
the minimum and maximum of the second figure are determined. The vectors
result from the relation of the maximum of the first derivative to the
minimum of the second derivative and from the maximum of the first
derivative to the maximum of the second derivative. In a simple
trigonometric approach, the scalar product of the two vectors is formed
first. Then the absolute values are calculated and multiplied by each other.
Finally, the value is converted into an angle with the cosine. The
assumption is that flat (negative amplification curves) have a large angle
and sigmoid (positive amplification curves) have a smaller angle. Another
assumption is that this angle is independent of the rotation of the
amplification curve. This means that systematic off-sets, such as those
caused by incorrect background correction, are of no consequence.
The cycles to be analyzed is defined by the user.
The output contains the angle." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PCRedux</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.6.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/PCRedux.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/SI1.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>winklR: A function to calculate the angle based on the first and the second #' derivative of an amplification curve data
from a quantitative PCR experiment.</h1>
    
    <div class="hidden name"><code>winklR.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><code>winklR</code> is a function to calculate the in the trajectory of the first
and the second derivatives maxima and minima  of an amplification curve data
from a quantitative PCR experiment. For the determination of the angle, the
origin is the maximum of the first derivative. On this basis, the vectors to
the minimum and maximum of the second figure are determined. The vectors
result from the relation of the maximum of the first derivative to the
minimum of the second derivative and from the maximum of the first
derivative to the maximum of the second derivative. In a simple
trigonometric approach, the scalar product of the two vectors is formed
first. Then the absolute values are calculated and multiplied by each other.
Finally, the value is converted into an angle with the cosine. The
assumption is that flat (negative amplification curves) have a large angle
and sigmoid (positive amplification curves) have a smaller angle. Another
assumption is that this angle is independent of the rotation of the
amplification curve. This means that systematic off-sets, such as those
caused by incorrect background correction, are of no consequence.
The cycles to be analyzed is defined by the user.
The output contains the angle.</p>
    
    </div>

    <pre class="usage"><span class='fu'>winklR</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>normalize</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>preprocess</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>is the cycle numbers (x-axis). By default the first ten cycles are removed.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>is the cycle dependent fluorescence amplitude (y-axis).</p></td>
    </tr>
    <tr>
      <th>normalize</th>
      <td><p>is a logical parameter, which indicates if the amplification curve
data should be normalized to the 99 percent percentile of the amplification curve.</p></td>
    </tr>
    <tr>
      <th>preprocess</th>
      <td><p>is a logical parameter, which indicates if the amplification curve
data should be smoothed (Savitzky-Golay smoothing filter, useful for noisy, jagged data).</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/base/Trig.html'>acos</a></code>
 <code><a href='https://rdrr.io/pkg/MBmca/man/diffQ2.html'>diffQ2</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Calculate the angles for amplification curve data from the RAS002 data set</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>RAS002</span>)

<span class='co'># Plot the data</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>RAS002</span>[, <span class='fl'>1</span>],
  <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>RAS002</span>[, <span class='fl'>2</span>], <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Cycle"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"RFU"</span>,
  <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"RAS002 data set"</span>, <span class='kw'>lty</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"l"</span>
)</div><div class='img'><img src='winklR-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>winklR</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>RAS002</span>[, <span class='fl'>1</span>], <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>RAS002</span>[, <span class='fl'>2</span>])
<span class='no'>res</span></div><div class='output co'>#&gt; $angle
#&gt; [1] 2.00806
#&gt; 
#&gt; $origin
#&gt;               x         y
#&gt; origin 28.37007 -139.4272
#&gt; 
#&gt; $p1
#&gt;           x         y
#&gt; p1 26.13105 -40.00269
#&gt; 
#&gt; $p2
#&gt;        x        y
#&gt; p2 30.52 32.12933
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='no'>res</span>$<span class='no'>origin</span>, <span class='no'>res</span>$<span class='no'>p1</span>, <span class='no'>res</span>$<span class='no'>p2</span>), <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"black"</span>, <span class='st'>"green"</span>, <span class='st'>"blue"</span>))</div><div class='img'><img src='winklR-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>RAS002</span>[, <span class='fl'>1</span>],
  <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>RAS002</span>[, <span class='fl'>7</span>], <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Cycle"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"RFU"</span>,
  <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"RAS002 data set"</span>, <span class='kw'>lty</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"l"</span>
)</div><div class='img'><img src='winklR-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>winklR</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>RAS002</span>[, <span class='fl'>1</span>], <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>RAS002</span>[, <span class='fl'>7</span>])
<span class='no'>res</span></div><div class='output co'>#&gt; $angle
#&gt; [1] 0.735405
#&gt; 
#&gt; $origin
#&gt;               x         y
#&gt; origin 35.28768 -19.39072
#&gt; 
#&gt; $p1
#&gt;           x         y
#&gt; p1 28.32055 -4.216406
#&gt; 
#&gt; $p2
#&gt;          x       y
#&gt; p2 24.9437 2.39646
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='no'>res</span>$<span class='no'>origin</span>, <span class='no'>res</span>$<span class='no'>p1</span>, <span class='no'>res</span>$<span class='no'>p2</span>), <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"black"</span>, <span class='st'>"green"</span>, <span class='st'>"blue"</span>))</div><div class='img'><img src='winklR-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='no'>res_angles</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span>(<span class='fl'>2</span>:<span class='fl'>21</span>, <span class='kw'>function</span>(<span class='no'>i</span>) {
  <span class='fu'>winklR</span>(<span class='no'>RAS002</span>[, <span class='fl'>1</span>], <span class='no'>RAS002</span>[, <span class='no'>i</span>])$<span class='no'>angle</span>
}))
<span class='fu'><a href='https://rdrr.io/r/graphics/cdplot.html'>cdplot</a></span>(<span class='no'>RAS002_decisions</span>[<span class='fl'>1L</span>:<span class='fl'>20</span>] ~ <span class='no'>res_angles</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"angle"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"decision"</span>)</div><div class='img'><img src='winklR-5.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Stefan Roediger</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Stefan Roediger, Michal Burdukiewicz, Andrej-Nikolai Spiess, Konstantin A. Blagodatskikh.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


